{% load static %}

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Donor Dash | Services</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href={% static 'css/global.css' %}>
        <link rel="icon" href={% static 'images/favicon.ico' %}>
        <link href="https://cdn.jsdelivr.net/npm/keen-slider@6.8.6/keen-slider.min.css" rel="stylesheet"/>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-white">
        <nav class="bg-white w-full border-b-4 border-red-500 shadow-inner shadow-red-200 fixed z-50">
            <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
                <a href="/" class="flex items-center hover:scale-105 hover:text-red-500 duration-300">
                    <img src={% static 'images/favicon.ico' %} class="h-8 mr-3" alt="Donor Dash Logo">
                    <span class="self-center text-2xl font-semibold whitespace-nowrap cursor-pointer font-header">Donor Dash</span>
                </a>
                <div class="flex md:order-2">
                    <a href="/login" {% if user.is_authenticated %} style="visibility:hidden;" disabled {% endif %}><button type="button" class="text-white bg-red-600 hover:bg-red-700 focus:ring-2 focus:ring-black rounded-lg text-md px-4 py-2 text-center mr-3 md:mr-0 font-button">Log In</button></a>
                    <button onClick="toggle()" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 " aria-controls="navbar-sticky" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="w-5 h-5 text-red-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
                        </svg>
                    </button>
                </div>
                <div class="items-center justify-between w-full md:flex md:w-auto md:order-1 hidden" id="navbar-sticky">
                    <ul class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white">
                        <li><a href="/" class="block py-2 pl-3 pr-4 font-link text-gray-900 rounded hover:bg-gray-100 hover:text-red-500 md:text-xl md:hover:bg-transparent md:hover:text-red-500 md:p-0 hover:scale-105 duration-300 ">Home</a></li>
                        <li><a href="/about" class="block py-2 pl-3 pr-4 font-link text-gray-900 rounded hover:bg-gray-100 hover:text-red-500 md:text-xl md:hover:bg-transparent md:hover:text-red-500 md:p-0 hover:scale-105 duration-300 ">About</a></li>
                        <li><a href="/services" class="block py-2 pl-3 pr-4 font-link text-white bg-red-500 rounded md:text-xl md:bg-transparent md:text-red-500 md:p-0 hover:scale-105 duration-300 ">Services</a></li>
                        <li><a href="/login" class="block py-2 pl-3 pr-4 font-link text-gray-900 rounded hover:bg-gray-100 hover:text-red-500 md:text-xl md:hover:bg-transparent md:hover:text-red-500 md:p-0 hover:scale-105 duration-300 ">Dashboard</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <main class="bg-white w-full mb-20 pt-20">

            <section class="w-full">
                <div class="relative overflow-hidden py-6">
                    <div id="ad" class="group flex justify-between items-center relative cursor-pointer overflow-hidden px-6 pt-2 pb-2 shadow-xl ring-1 ring-gray-900/5 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl sm:mx-auto rounded-2xl">
                        <span class="absolute my-auto grid h-10 w-10 rounded-full bg-red-500 transition-all duration-300 group-hover:scale-[100]"></span>
                        <span class="absolute my-auto grid h-10 w-10 place-items-center rounded-full bg-red-500 transition-all duration-1000 group-hover:bg-red-400">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 text-white transition-all">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 9.75a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 01.778-.332 48.294 48.294 0 005.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z" />
                            </svg>
                        </span>
                        <div class="relative flex justify-between items-center z-10 mx-auto">
                            <div class="flex items-center justify-between font-link text-center mx-10 py-3 text-base text-gray-600 transition-all duration-300 group-hover:text-white/90">
                                <p class="text-center">{{ quote }}</p>
                            </div>
                        </div>
                        <div class="text-base font-semibold leading-7  z-10 group-hover:text-white/90">
                            <button id="ad-close" type="button" class="bg-white rounded-md p-2 inline-flex items-center justify-center hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-red-200">
                                <span class="sr-only">Close menu</span>
                                <svg class="h-6 w-6 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <section class="container px-10 mx-auto py-10">
                <div class="sm:flex sm:items-center sm:justify-between">
                    <div>
                        <div class="flex items-center gap-x-3">
                            <h1 class="font-h font-bold border-red-500 text-5xl">
                                Blood Camps
                            </h1>
                        </div>

                        <p class="mt-1 text-md font-link text-red-500">See the lastest blood camps around you</p>
                    </div>
                </div>

                <div class="mt-6 md:flex md:items-center md:justify-between">
                    <div class="inline-flex overflow-hidden bg-white border  divide-x rounded-lg rtl:flex-row-reverse">
                        <button id="option_0" class="option font-button px-5 py-2 text-xs font-bold text-red-500 transition-colors duration-200 lg:text-sm hover:bg-gray-200">
                            View all
                        </button>

                        <button id="option_1" class="option font-button px-5 py-2 text-xs font-bold text-red-500 transition-colors duration-200 lg:text-sm hover:bg-gray-200">
                            Planned
                        </button>

                        <button id="option_2" class="option font-button px-5 py-2 text-xs font-bold text-red-500 transition-colors duration-200 lg:text-sm hover:bg-gray-200">
                            Ongoing
                        </button>

                        <button id="option_3" class="option font-button px-5 py-2 text-xs font-bold text-red-500 transition-colors duration-200 lg:text-sm hover:bg-gray-200">
                            Past
                        </button>
                    </div>

                    <div class="relative flex items-center mt-4 md:mt-0">
                        <span class="absolute">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mx-3 font-bold font-button text-red-500">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                            </svg>
                        </span>
                        <span id="mic-button" class="absolute right-0">
                            <svg id="mic" version="1.1" fill="red" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" class="w-7 h-7 mx-3 font-bold font-button rounded-full bg-gray-200 p-1 hover:bg-red-200 hover:scale-105 duration-200">
                                <path d="m439.5,236c0-11.3-9.1-20.4-20.4-20.4s-20.4,9.1-20.4,20.4c0,70-64,126.9-142.7,126.9-78.7,0-142.7-56.9-142.7-126.9 0-11.3-9.1-20.4-20.4-20.4s-20.4,9.1-20.4,20.4c0,86.2 71.5,157.4 163.1,166.7v57.5h-23.6c-11.3,0-20.4,9.1-20.4,20.4 0,11.3 9.1,20.4 20.4,20.4h88c11.3,0 20.4-9.1 20.4-20.4 0-11.3-9.1-20.4-20.4-20.4h-23.6v-57.5c91.6-9.3 163.1-80.5 163.1-166.7z"/>
                                <path d="m256,323.5c51,0 92.3-41.3 92.3-92.3v-127.9c0-51-41.3-92.3-92.3-92.3s-92.3,41.3-92.3,92.3v127.9c0,51 41.3,92.3 92.3,92.3zm-52.3-220.2c0-28.8 23.5-52.3 52.3-52.3s52.3,23.5 52.3,52.3v127.9c0,28.8-23.5,52.3-52.3,52.3s-52.3-23.5-52.3-52.3v-127.9z"/>
                              </svg>
                        </span>
                        <input id="search" type="text" placeholder="Press 'Shift' to search" class="font-button text-red-500 block w-full py-1.5 pr-16 text-red-500 bg-white border border-gray-200 rounded-lg md:w-80 placeholder-gray-400/70 pl-11 rtl:pr-11 rtl:pl-5 focus:ring-red-300 focus:outline-none focus:ring focus:ring-opacity-40">
                    </div>
                </div>

                <div class="flex flex-col mt-6">
                    <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-8">
                        <div class="inline-block min-w-full py-2 align-middle md:px-8 lg:px-8">
                            <div class="overflow-hidden border border-gray-200 rounded-lg">


                                <table class="font-button min-w-full divide-y divide-gray-200">
                                    <thead class="bg-red-500">
                                        <tr>
                                            <th scope="col" class="font-button text-center py-3.5 px-4 text-sm font-bold text-left rtl:text-right text-white">
                                                <div>Camp</div>
                                            </th>

                                            <th scope="col" class="font-button text-center py-3.5 px-4 text-sm font-bold text-left rtl:text-right text-white">
                                                Status
                                            </th>

                                            <th scope="col" class="font-button text-center py-3.5 px-4 text-sm font-bold text-left rtl:text-right text-white">
                                                Address
                                            </th>

                                            <th scope="col" class="font-button text-center py-3.5 px-4 text-sm font-bold text-left rtl:text-right text-white">
                                                City
                                            </th>

                                            <th scope="col" class="font-button text-center py-3.5 px-4 text-sm font-bold text-left rtl:text-right text-white">
                                                BloodBank
                                            </th>

                                            <th scope="col" class="relative py-3.5 px-4">
                                                <span class="sr-only">Edit</span>
                                            </th>
                                        </tr>
                                    </thead>

                                    
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        {% for camp in camps %}
                                        <tr>
                                            <td class="px-4 py-4 text-sm font-medium whitespace-nowrap">
                                                <div>
                                                    <h2 class="text-center font-bold text-gray-800">{{ camp.name }}</h2>
                                                    <p class="text-center text-sm font-normal text-gray-600">{{ camp.start_date }} to {{ camp.end_date }}</p>
                                                </div>
                                            </td>
                                            <td class="center px-12 py-4 text-sm font-medium whitespace-nowrap">
                                                {% if today_date < camp.start_date %}
                                                <div class="text-center px-3 py-1 text-sm font-bold rounded-full text-yellow-500 gap-x-2 bg-yellow-100/60 ">
                                                    Planned
                                                </div>
                                                {% elif camp.start_date <= today_date and  today_date <= camp.end_date %}
                                                <div class="text-center px-3 py-1 text-sm font-bold rounded-full text-emerald-500 gap-x-2 bg-emerald-100/60 ">
                                                    Ongoing
                                                </div>
                                                {% elif camp.end_date < today_date %}
                                                <div class="text-center px-3 py-1 text-sm font-bold rounded-full text-gray-500 gap-x-2 bg-gray-100/60 ">
                                                    Past
                                                </div>
                                                {% else %}
                                                <div class="text-center px-3 py-1 text-sm font-bold rounded-full text-blue-500 gap-x-2 bg-blue-100/60 ">
                                                    {{ today_date }}
                                                </div>
                                                {% endif %}
                                            </td>
                                            <td class="px-4 py-4 text-sm whitespace-nowrap">
                                                <div>
                                                    <h4 class="text-center font-bold text-gray-700 ">{{ camp.address }}</h4>
                                                    <p class="text-center text-gray-500 ">PIN - {{ camp.pincode }}</p>
                                                </div>
                                            </td>
                                            <td class="px-4 py-4 text-sm whitespace-nowrap">
                                                <div>
                                                    <h4 class="text-center font-bold text-gray-700 ">{{ camp.city.city_name }}</h4>
                                                    <p class="text-center text-gray-500 ">{{ camp.city.state }}</p>
                                                </div>
                                            </td>

                                            <td class="px-4 py-4 text-sm whitespace-nowrap">
                                                <div>
                                                    <h2 class="text-center font-bold text-gray-800 ">{{ camp.bloodbank.bloodbank_name }}</h2>
                                                </div>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                    
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-6 sm:flex sm:items-center sm:justify-between ">
                    <div class="text-sm text-gray-500 ">
                        Page <span class="font-medium text-gray-700">{{ current_page_number }} of {{ total_page_number }}</span> 
                    </div>

                    <div class="flex items-center mt-4 gap-x-4 sm:mt-0">
                        <button id="previous" href="#" {% if current_page_number == 1 or current_page_number == 0 %}disabled{% endif %} class="disabled:opacity-0 flex items-center justify-center w-1/2 px-5 py-2 text-sm text-gray-700 capitalize transition-colors duration-200 bg-white border rounded-md sm:w-auto gap-x-2 hover:bg-gray-100 ">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 rtl:-scale-x-100">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 15.75L3 12m0 0l3.75-3.75M3 12h18" />
                            </svg>
                            <span>
                                previous
                            </span>
                        </button>

                        <button id="next" href="#" {% if current_page_number == total_page_number %}disabled{% endif %} class="disabled:opacity-0 flex items-center justify-center w-1/2 px-5 py-2 text-sm text-gray-700 capitalize transition-colors duration-200 bg-white border rounded-md sm:w-auto gap-x-2 hover:bg-gray-100 ">
                            <span>
                                Next
                            </span>
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 rtl:-scale-x-100">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3" />
                            </svg>
                        </button>
                    </div>
                </div>
            </section>


        </main>


        <footer class="fixed bottom-0 left-0 z-20 w-full p-4 bg-white border-t border-red-500 shadow md:flex md:items-center md:justify-between md:p-6">
            <span class="text-sm text-gray-500 sm:text-center">© 2023 <a target="_blank" href="https://github.com/SilverDragonOfR" class="hover:underline">SilverDragonOfR</a> & <a target="_blank" href="https://github.com/SaiAdarshP" class="hover:underline">SaiAdarshP</a>.</span>
            <div class="flex mt-4 space-x-5 sm:justify-center md:mt-0">
                <a href="/" class="text-gray-400 hover:text-red-500 hover:scale-125 duration-300">
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 8 19">
                        <path fill-rule="evenodd" d="M6.135 3H8V0H6.135a4.147 4.147 0 0 0-4.142 4.142V6H0v3h2v9.938h3V9h2.021l.592-3H5V3.591A.6.6 0 0 1 5.592 3h.543Z" clip-rule="evenodd"/>
                    </svg>
                    <span class="sr-only">Facebook page</span>
                </a>
                <a href="/" class="text-gray-400 hover:text-red-500 hover:scale-125 duration-300">
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 17">
                        <path fill-rule="evenodd" d="M20 1.892a8.178 8.178 0 0 1-2.355.635 4.074 4.074 0 0 0 1.8-2.235 8.344 8.344 0 0 1-2.605.98A4.13 4.13 0 0 0 13.85 0a4.068 4.068 0 0 0-4.1 4.038 4 4 0 0 0 .105.919A11.705 11.705 0 0 1 1.4.734a4.006 4.006 0 0 0 1.268 5.392 4.165 4.165 0 0 1-1.859-.5v.05A4.057 4.057 0 0 0 4.1 9.635a4.19 4.19 0 0 1-1.856.07 4.108 4.108 0 0 0 3.831 2.807A8.36 8.36 0 0 1 0 14.184 11.732 11.732 0 0 0 6.291 16 11.502 11.502 0 0 0 17.964 4.5c0-.177 0-.35-.012-.523A8.143 8.143 0 0 0 20 1.892Z" clip-rule="evenodd"/>
                    </svg>
                    <span class="sr-only">Twitter page</span>
                </a>
                <a href="/" class="text-gray-400 hover:text-red-500 hover:scale-125 duration-300">
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.5rg/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z" clip-rule="evenodd"/>
                    </svg>
                    <span class="sr-only">GitHub account</span>
                </a>
            </div>
        </footer>
    </body>

    <script>
        const search_bar = document.querySelector("#search")
        search_bar.value = "{{ q_old }}"
        document.addEventListener("keydown", (e) => {
            if(e.keyCode === 16 ) {
                search_bar.focus()
            } else if(e.keyCode === 13 ) {
                const url = `/services/?pg=1&op={{ option }}&q=${search_bar.value}`
                window.location = url
            }
        })
    </script>

    <script>
        previous = document.querySelector("#previous")
        next = document.querySelector("#next")
        previous.addEventListener("click", () => {
            const url = `/services/?pg={{ current_page_number|add:-1 }}&op={{ option }}&q=${search_bar.value}`
            window.location = url
        })
        next.addEventListener("click", () => {
            const url = `/services/?pg={{ current_page_number|add:1 }}&op={{ option }}&q=${search_bar.value}`
            window.location = url
        })
    </script>

    <style>
        .toRemove {
            animation: collapse .5s ease;
            animation-fill-mode: forwards;
                a:after {
                    display: none !important;
                }
            }
        
        @keyframes collapse {
            0% {
                opacity: 100%;
            }
            100% {
                opacity: 0%
            }
        }
    </style>

    <script>
        const ad = document.querySelector("#ad")
        const adClose = document.querySelector("#ad-close")
        adClose.addEventListener("click", (e) => {
            ad.classList.add('toRemove');
            setTimeout(function () {
                ad.remove();
            }, 500);
            e.preventDefault();
        })
    </script>

    <script>
        options = document.querySelectorAll(".option")
        options.forEach((option, i) => {
            option.addEventListener("click", () => {
                const url = `/services/?pg=1&op=${i}`
                window.location = url
            })
        })
    </script>

    <script>
        option_sel = document.querySelector("#option_"+{{ option }})
        option_sel.className = "option font-button px-5 py-2 text-xs font-bold text-white transition-colors duration-200 bg-red-500 lg:text-sm"
    </script>

    <script>
        micButton = document.querySelector("#mic-button")
        mic = document.querySelector("#mic")
        search = document.querySelector("#search")
        window.SpeechRecognition = window.webkitSpeechRecognition
        const recognition = new SpeechRecognition()
        recognition.interimResults = true
        isRec = false
        recognition.addEventListener("result", (e) => {
            const transcript = Array.from(e.results).map(result => result[0]).map(result => result.transcript)
            search.value = transcript
            search.scrollLeft = search.scrollWidth;
        })

        recognition.addEventListener("audioend", (e) => {
            recognition.stop()
            mic.setAttribute("fill", "red")   
            mic.style.backgroundColor = "#e5e7eb" 
            isRec = false
            const kbEvent = new KeyboardEvent("keydown", {
                bubbles : true,
                cancelable : true,
                key : "Enter",
                keyCode : 13
            })
            document.dispatchEvent(kbEvent)
        })

        mic.addEventListener("click", () => {
            if(isRec) {
                recognition.stop()
                mic.setAttribute("fill", "red")   
                mic.style.backgroundColor = "#e5e7eb"  
                
                const kbEvent = new KeyboardEvent("keydown", {
                    bubbles : true,
                    cancelable : true,
                    key : "Enter",
                    keyCode : 13
                })
                document.dispatchEvent(kbEvent)

            } else {
                recognition.start()
                mic.setAttribute("fill", "green")
                mic.style.backgroundColor = "#98fb98"
            }
            isRec = !isRec
        })
    </script>

    <script defer type="module" src={% static "/js/keenslider.js"%}></script>
    <script defer src={% static "js/toggle.js" %}></script>
</html>